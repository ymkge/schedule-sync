# Schedule Sync (スケジュール同期アプリ)

Schedule Syncは、CalendlyやSpirのような日程調整アプリケーションです。あなたのGoogleカレンダーと連携し、空き時間を自動的に見つけ出し、他の人が簡単に会議を予約できるユニークな共有リンクを提供します。

## 主な機能

- **Googleカレンダー連携**: OAuth 2.0を使用して、安全にGoogleカレンダーに接続します。
- **空き時間の自動生成**: カレンダーの予定やあらかじめ設定した稼働時間に基づき、予約可能な時間枠を自動で計算します。
- **週別カレンダー表示**: 同期した予約枠を、週ごとのカレンダー形式で視覚的に確認できます。
- **共有可能な予約リンク**: あなた専用の予約ページのユニークなURLを生成します。
- **ワンクリック予約**: 面倒なやり取りなしに、数クリックで予約が完了します。
- **会議リンクの自動発行**: 予約されたイベントごとに、Google Meetの会議リンクが自動で作成されます。
- **ダブルブッキング防止**: ある時間枠が予約されると、他の人が同じ時間を予約することはできません。

## 技術スタック

- **フロントエンド**: Next.js, React, TypeScript, Tailwind CSS
- **バックエンド**: Python, FastAPI
- **データベース**: Google Cloud Firestore
- **API・認証**: Google Calendar API, Google People API, Google OAuth 2.0
- **デプロイ環境 (計画)**: Docker, Google Cloud Run

## プロジェクト構造

```
/schedule-sync
├── /backend/      # FastAPI アプリケーション (バックエンド)
└── /frontend/     # Next.js アプリケーション (フロントエンド)
```

## ローカル開発環境のセットアップ

### 前提条件

- Node.js (v18 以上)
- Python (v3.9 以上)
- Google Cloud プロジェクトが作成済みであること
- `gcloud` CLI がインストール・認証済みであること
- Google Cloud プロジェクトで **Cloud Firestore API が有効化済み** であること
- コンピュータのシステム時刻が正しく設定されていること

### 1. バックエンドのセットアップ

(変更なし)

### 2. フロントエンドのセットアップ

1.  **フロントエンドディレクトリに移動します:**
    ```bash
    cd frontend
    ```

2.  **必要なライブラリをインストールします:**
    ```bash
    npm install
    ```

3.  **環境変数を設定します:**
    - `frontend`ディレクトリの直下に`.env.local`というファイルを作成します。
    - ファイルに以下の内容を記述します。これにより、フロントエンドがバックエンドAPIの場所を認識できるようになります。
      ```
      NEXT_PUBLIC_API_BASE_URL=http://127.0.0.1:8080
      ```

4.  **フロントエンドサーバーを起動します:**
    ```bash
    npm run dev
    ```
    アプリケーションが `http://localhost:3000` で利用可能になります。

## 利用方法

1.  **ログイン**: `http://localhost:3000` にアクセスし、Googleアカウントでログインします。
2.  **カレンダー同期**: ログイン後、ダッシュボードが表示されます。「Re-Sync Calendar」ボタンを押すと、Googleカレンダーとの同期が実行されます。
3.  **予約枠の確認**: 同期が完了すると、予約可能な時間枠が週別のカレンダー形式でダッシュボードに表示されます。「‹ Prev」「Next ›」ボタンで週を移動できます。
4.  **リンク共有**: (今後実装) あなた専用の予約リンク（例: `http://localhost:3000/<あなたの公開トークン>`）を他の人に共有します。
5.  **予約受付**: (今後実装) 共有された相手はリンクにアクセスし、空いている時間を選んで予約します。予約内容は自動的にあなたのGoogleカレンダーに登録されます。

## 今後の開発タスク (Next Steps)

認証とカレンダー同期、そしてその結果を表示するダッシュボード機能までが完成しました。
次回は、他のユーザーが実際に予約を行うための公開ページの作成に取り組みます。

### Step 1: 公開予約ページのUI実装

- **目的**: 予約者が、あなたの公開URLにアクセスした際に、予約可能な時間枠をカレンダー形式で閲覧できるようにする。
- **対象ファイル**: `frontend/app/[token]/page.tsx`
- **作業**:
    1.  URLに含まれるトークンを元に、バックエンドの`/api/slots/public/{token}`を呼び出し、ユーザー名と予約枠のデータを取得します。
    2.  現在ログイン中のユーザー向けダッシュボードで実装したような、週別のカレンダービューをこのページにも実装します。
    3.  予約可能な時間セルをクリックした際に、予約者情報を入力するための確認フォーム（モーダルウィンドウなど）を表示する処理を追加します。

### Step 2: 予約作成機能の実装

- **目的**: 予約者が名前とメールアドレスを入力し、予約を確定できるようにする。
- **作業**:
    1.  上記Step1の確認フォームに、名前とメールアドレスの入力欄を設けます。
    2.  フォームの送信ボタンが押されたら、バックエンドの`POST /api/bookings`エンドポイントに必要な情報（`publicUrlToken`, `slotId`, `bookerName`, `bookerEmail`）を詰めてリクエストを送信します。
    3.  予約が成功したこと、または失敗したことを示すメッセージを画面に表示します。

### Step 3: 全体的な品質向上

- **目的**: アプリケーションをより堅牢で使いやすくする。
- **作業**:
    - ユーザー設定機能の追加（予約枠の長さ、稼働時間など）。
    - スマートフォンなど、様々な画面サイズに対応するためのレスポンシブデザインの改善。
    - エラーハンドリングやローディング表示の洗練。

## ライセンス

このプロジェクトは **MITライセンス** の下で公開されています。詳細は [LICENSE](LICENSE) ファイルをご覧ください。
